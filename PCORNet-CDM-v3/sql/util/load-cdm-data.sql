INSERT INTO pcori_cdmv3.pcori_cdmv3.demographic (patid,
                                                 birth_date,
                                                 birth_time,
                                                 sex,
                                                 hispanic,
                                                 race,
                                                 biobank_flag,
                                                 raw_sex,
                                                 raw_hispanic,
                                                 raw_race)
    SELECT
        patid,
        birth_date,
        birth_time,
        sex,
        hispanic,
        race,
        biobank_flag,
        raw_sex,
        raw_hispanic,
        raw_race
    FROM pcori_cdmv3_test.pcori_cdmv3.demographic
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.enrollment (patid,
                                                enr_start_date,
                                                enr_end_date,
                                                chart,
                                                enr_basis)
    SELECT
        patid,
        enr_start_date,
        enr_end_date,
        chart,
        enr_basis
    FROM pcori_cdmv3_test.pcori_cdmv3.enrollment
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.encounter (encounterid,
                                               patid,
                                               admit_date,
                                               admit_time,
                                               discharge_date,
                                               discharge_time,
                                               providerid,
                                               facility_location,
                                               enc_type,
                                               facilityid,
                                               discharge_disposition,
                                               discharge_status,
                                               drg,
                                               drg_type,
                                               admitting_source,
                                               raw_siteid,
                                               raw_enc_type,
                                               raw_discharge_disposition,
                                               raw_discharge_status,
                                               raw_drg_type,
                                               raw_admitting_source)
    SELECT
        encounterid,
        patid,
        admit_date,
        admit_time,
        discharge_date,
        discharge_time,
        providerid,
        facility_location,
        enc_type,
        facilityid,
        discharge_disposition,
        discharge_status,
        drg,
        drg_type,
        admitting_source,
        raw_siteid,
        raw_enc_type,
        raw_discharge_disposition,
        raw_discharge_status,
        raw_drg_type,
        raw_admitting_source
    FROM pcori_cdmv3_test.pcori_cdmv3.encounter
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.diagnosis (diagnosisid,
                                               patid,
                                               encounterid,
                                               enc_type,
                                               admit_date,
                                               providerid,
                                               dx,
                                               dx_type,
                                               dx_source,
                                               pdx,
                                               raw_dx,
                                               raw_dx_type,
                                               raw_dx_source,
                                               raw_pdx)
    SELECT
        diagnosisid,
        patid,
        encounterid,
        enc_type,
        admit_date,
        providerid,
        dx,
        dx_type,
        dx_source,
        pdx,
        raw_dx,
        raw_dx_type,
        raw_dx_source,
        raw_pdx
    FROM pcori_cdmv3_test.pcori_cdmv3.diagnosis
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.procedures (proceduresid,
                                                patid,
                                                encounterid,
                                                enc_type,
                                                admit_date,
                                                providerid,
                                                px_date,
                                                px,
                                                px_type,
                                                px_source,
                                                raw_px,
                                                raw_px_type)
    SELECT
        proceduresid,
        patid,
        encounterid,
        enc_type,
        admit_date,
        providerid,
        px_date,
        px,
        px_type,
        px_source,
        raw_px,
        raw_px_type
    FROM pcori_cdmv3_test.pcori_cdmv3.procedures
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.vital (vitalid,
                                           patid,
                                           encounterid,
                                           measure_date,
                                           measure_time,
                                           vital_source,
                                           ht,
                                           wt,
                                           diastolic,
                                           systolic,
                                           original_bmi,
                                           bp_position,
                                           smoking,
                                           tobacco,
                                           tobacco_type,
                                           raw_diastolic,
                                           raw_systolic,
                                           raw_bp_position,
                                           raw_smoking,
                                           raw_tobacco,
                                           raw_tobacco_type)
    SELECT
        vitalid,
        patid,
        encounterid,
        measure_date,
        measure_time,
        vital_source,
        ht,
        wt,
        diastolic,
        systolic,
        original_bmi,
        bp_position,
        smoking,
        tobacco,
        tobacco_type,
        raw_diastolic,
        raw_systolic,
        raw_bp_position,
        raw_smoking,
        raw_tobacco,
        raw_tobacco_type
    FROM pcori_cdmv3_test.pcori_cdmv3.vital
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.prescribing (prescribingid,
                                                 patid,
                                                 encounterid,
                                                 rx_providerid,
                                                 rx_order_date,
                                                 rx_order_time,
                                                 rx_start_date,
                                                 rx_end_date,
                                                 rx_quantity,
                                                 rx_refills,
                                                 rx_days_supply,
                                                 rx_frequency,
                                                 rx_basis,
                                                 rxnorm_cui,
                                                 raw_rx_med_name,
                                                 raw_rx_frequency,
                                                 raw_rxnorm_cui)
    SELECT
        prescribingid,
        patid,
        encounterid,
        rx_providerid,
        rx_order_date,
        rx_order_time,
        rx_start_date,
        rx_end_date,
        rx_quantity,
        rx_refills,
        rx_days_supply,
        rx_frequency,
        rx_basis,
        rxnorm_cui,
        raw_rx_med_name,
        raw_rx_frequency,
        raw_rxnorm_cui
    FROM pcori_cdmv3_test.pcori_cdmv3.prescribing
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.dispensing (dispensingid,
                                                patid,
                                                prescribingid,
                                                dispense_date,
                                                ndc,
                                                dispense_sup,
                                                dispense_amt,
                                                raw_ndc)
    SELECT
        dispensingid,
        patid,
        prescribingid,
        dispense_date,
        ndc,
        dispense_sup,
        dispense_amt,
        raw_ndc
    FROM pcori_cdmv3_test.pcori_cdmv3.dispensing
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.lab_result_cm (lab_result_cm_id,
                                                   patid,
                                                   encounterid,
                                                   lab_name,
                                                   specimen_source,
                                                   lab_loinc,
                                                   priority,
                                                   result_loc,
                                                   lab_px,
                                                   lab_px_type,
                                                   lab_order_date,
                                                   specimen_date,
                                                   specimen_time,
                                                   result_date,
                                                   result_time,
                                                   result_qual,
                                                   result_num,
                                                   result_modifier,
                                                   result_unit,
                                                   norm_range_low,
                                                   norm_modifier_low,
                                                   norm_range_high,
                                                   norm_modifier_high,
                                                   abn_ind,
                                                   raw_lab_name,
                                                   raw_lab_code,
                                                   raw_panel,
                                                   raw_result,
                                                   raw_unit,
                                                   raw_order_dept,
                                                   raw_facility_code)
    SELECT
        lab_result_cm_id,
        patid,
        encounterid,
        lab_name,
        specimen_source,
        lab_loinc,
        priority,
        result_loc,
        lab_px,
        lab_px_type,
        lab_order_date,
        specimen_date,
        specimen_time,
        result_date,
        result_time,
        result_qual,
        result_num,
        result_modifier,
        result_unit,
        norm_range_low,
        norm_modifier_low,
        norm_range_high,
        norm_modifier_high,
        abn_ind,
        raw_lab_name,
        raw_lab_code,
        raw_panel,
        raw_result,
        raw_unit,
        raw_order_dept,
        raw_facility_code
    FROM pcori_cdmv3_test.pcori_cdmv3.lab_result_cm
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.condition (conditionid,
                                               patid,
                                               encounterid,
                                               report_date,
                                               resolve_date,
                                               onset_date,
                                               condition_status,
                                               condition,
                                               condition_type,
                                               condition_source,
                                               raw_condition_status,
                                               raw_condition,
                                               raw_condition_type,
                                               raw_condition_source)
    SELECT
        conditionid,
        patid,
        encounterid,
        report_date,
        resolve_date,
        onset_date,
        condition_status,
        condition,
        condition_type,
        condition_source,
        raw_condition_status,
        raw_condition,
        raw_condition_type,
        raw_condition_source
    FROM pcori_cdmv3_test.pcori_cdmv3.condition
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.pro_cm (pro_cm_id,
                                            patid,
                                            encounterid,
                                            pro_item,
                                            pro_loinc,
                                            pro_date,
                                            pro_time,
                                            pro_response,
                                            pro_method,
                                            pro_mode,
                                            pro_cat,
                                            raw_pro_code,
                                            raw_pro_response)
    SELECT
        pro_cm_id,
        patid,
        encounterid,
        pro_item,
        pro_loinc,
        pro_date,
        pro_time,
        pro_response,
        pro_method,
        pro_mode,
        pro_cat,
        raw_pro_code,
        raw_pro_response
    FROM pcori_cdmv3_test.pcori_cdmv3.pro_cm
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.pcornet_trial (patid,
                                                   trialid,
                                                   participantid,
                                                   trial_siteid,
                                                   trial_enroll_date,
                                                   trial_end_date,
                                                   trial_withdraw_date,
                                                   trial_invite_code)
    SELECT
        patid,
        trialid,
        participantid,
        trial_siteid,
        trial_enroll_date,
        trial_end_date,
        trial_withdraw_date,
        trial_invite_code
    FROM pcori_cdmv3_test.pcori_cdmv3.pcornet_trial
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.death (patid,
                                           death_date,
                                           death_date_impute,
                                           death_source,
                                           death_match_confidence)
    SELECT
        patid,
        death_date,
        death_date_impute,
        death_source,
        death_match_confidence
    FROM pcori_cdmv3_test.pcori_cdmv3.death
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.death_cause (patid,
                                                 death_cause,
                                                 death_cause_code,
                                                 death_cause_type,
                                                 death_cause_source,
                                                 death_cause_confidence)
    SELECT
        patid,
        death_cause,
        death_cause_code,
        death_cause_type,
        death_cause_source,
        death_cause_confidence
    FROM pcori_cdmv3_test.pcori_cdmv3.death_cause
GO

INSERT INTO pcori_cdmv3.pcori_cdmv3.harvest (networkid,
                                             network_name,
                                             datamartid,
                                             datamart_name,
                                             datamart_platform,
                                             cdm_version,
                                             datamart_claims,
                                             datamart_ehr,
                                             birth_date_mgmt,
                                             enr_start_date_mgmt,
                                             enr_end_date_mgmt,
                                             admit_date_mgmt,
                                             discharge_date_mgmt,
                                             px_date_mgmt,
                                             rx_order_date_mgmt,
                                             rx_start_date_mgmt,
                                             rx_end_date_mgmt,
                                             dispense_date_mgmt,
                                             lab_order_date_mgmt,
                                             specimen_date_mgmt,
                                             result_date_mgmt,
                                             measure_date_mgmt,
                                             onset_date_mgmt,
                                             report_date_mgmt,
                                             resolve_date_mgmt,
                                             pro_date_mgmt,
                                             refresh_demographic_date,
                                             refresh_enrollment_date,
                                             refresh_encounter_date,
                                             refresh_diagnosis_date,
                                             refresh_procedures_date,
                                             refresh_vital_date,
                                             refresh_dispensing_date,
                                             refresh_lab_result_cm_date,
                                             refresh_condition_date,
                                             refresh_pro_cm_date,
                                             refresh_prescribing_date,
                                             refresh_pcornet_trial_date,
                                             refresh_death_date,
                                             refresh_death_cause_date)
    SELECT
        networkid,
        network_name,
        datamartid,
        datamart_name,
        datamart_platform,
        cdm_version,
        datamart_claims,
        datamart_ehr,
        birth_date_mgmt,
        enr_start_date_mgmt,
        enr_end_date_mgmt,
        admit_date_mgmt,
        discharge_date_mgmt,
        px_date_mgmt,
        rx_order_date_mgmt,
        rx_start_date_mgmt,
        rx_end_date_mgmt,
        dispense_date_mgmt,
        lab_order_date_mgmt,
        specimen_date_mgmt,
        result_date_mgmt,
        measure_date_mgmt,
        onset_date_mgmt,
        report_date_mgmt,
        resolve_date_mgmt,
        pro_date_mgmt,
        refresh_demographic_date,
        refresh_enrollment_date,
        refresh_encounter_date,
        refresh_diagnosis_date,
        refresh_procedures_date,
        refresh_vital_date,
        refresh_dispensing_date,
        refresh_lab_result_cm_date,
        refresh_condition_date,
        refresh_pro_cm_date,
        refresh_prescribing_date,
        refresh_pcornet_trial_date,
        refresh_death_date,
        refresh_death_cause_date
    FROM pcori_cdmv3_test.pcori_cdmv3.harvest
GO
